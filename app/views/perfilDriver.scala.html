@(token: String, usuario: controllers.Models.User, form: play.data.Form[controllers.Models.User], strings:LocalizedStrings)

@main("Carona") {

<!DOCTYPE html>
<html lang="en">

    <head style="background-color: gray">
        <meta charset="UTF-8">
        <title>Carona</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("bootstrap/css/bootstrap.min.css")">
        <script src="@routes.Assets.versioned("javascripts/jquery-1.12.3.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.versioned("javascripts/hello.js")" type="text/javascript"></script>
        <script type="text/css">
            #page-header {
                text-align: center;
                background: grey !important;
            }
            body {
                background: blue;
                background-color: #1b6d85 !important;
            }
            .solicitation {
                width: 100%;
                height: 100%;
                cursor: pointer !important;
            }

        </script>
        <script type="text/javascript">
                function getLink(token) {
                    return "/newCarona/" + token;
                }
                document.getElementById("newCarona").href= getLink(@token)
        </script>
    </head>


    <body style="color: #1b6d85">
        <script language="JavaScript">
                function vai(combo){
                    var x = combo.selectedIndex;
                    var endereco = combo.options[x].value;
                    window.location.href = "@routes.UserController.changeUser()"
                }
        </script>
        <div  class="page-header" align="center" style="background-clip: border-box">
            <h1>Carona</h1>
        </div>
        <div class="row" style="background-color: #1b6d85">
            <div class="col-sm-6 col-md-4">
                <div class="thumbnail" style="margin: 10px">
                    <img src="@routes.Assets.versioned("images/images.jpg")" alt="...">
                    <div class="caption">
                        <h3>@strings.get("driver_driver"): @(usuario.getName())<br>(@usuario.getNumberOfVacancies() @strings.get("driver_seats_available")       @usuario.getNumberOfVacanciesFree() @strings.get("driver_seats_free"))</br></h3>
                    </div>
                    <div>
                        <select size="1" name="D1" onchange="vai(this);">
                            <option value="/perfilDriver">@strings.get("driver_driver")</option>
                            <option value="/perfilpassenger">@strings.get("driver_passenger")</option>
                        </select>
                    </div>
                    <div class="caption" style="margin-top: 0px">
                        <a href="/newCarona/@token">@strings.get("driver_carona")</a>
                    </div>
                    <div class="caption" style="margin-top: 0px">
                        <a href="/updateData">@strings.get("driver_update")</a>
                    </div>
                    <div class="caption" style="margin-top: 0px">
                        <a href="/logout">@strings.get("driver_logout")</a>
                    </div>

                </div>
            </div>
            <div class="col-sm-6" style="margin-top: 10px;">
                <div class="row">
                    <h1 style="color: #000000">@strings.get("driver_solicitations"):</h1>
                </div>
                <ul class="list-group">
                    @for(solicitationsIndex <- 0 to (usuario.getSolicitationsForCarona().size() -1)) {
                            <li class="list-group-item", name="linha" >
                                <div class="solicitation" name="solicitationsIndex">
                                    <div><img  style="width: 50px; height: 50px;display: block; float:left; margin:10px" src="@routes.Assets.versioned("images/images.jpg")" alt="..."></div>
                                    <div style="float: left">
                                        <ul class="list-group" style="display: inline; list-style-type:none;">
                                            <li><div style="margin-left:10px; float: left">@strings.get("driver_name"): @usuario.getSolicitationsForCarona().get(solicitationsIndex).getName()</div></li>
                                            <li><div style="margin-left:10px; float: left">@strings.get("driver_location"): @usuario.getSolicitationsForCarona().get(solicitationsIndex).getStartingAddress()</div></li>
                                            <li><div style="margin-left:10px; float: left">@strings.get("driver_hour"): @usuario.getSolicitationsForCarona().get(solicitationsIndex).getHour()</div></li>
                                        </ul>
                                    </div>
                                    <div style="float: right;">
                                        <button class="btn btn-success accept-solicitation" data-solicitation-id= "@solicitationsIndex"><i class="glyphicon glyphicon-ok"></i></button>
                                        <button class="btn btn-danger reject-solicitation" data-solicitation-id= "@solicitationsIndex"><i class="glyphicon glyphicon-remove"></i></button>
                                    </div>
                                    <div style="clear: both;"></div>
                                </div>
                           </li>
                    }
                </ul>
            </div>
        </div>
        <footer class="well well-lg" style="text-align: center">
        @strings.get("footer")
            @if(strings.getLanguage().equals("EN")) {
                <a href="#" onclick="setLanguage('PT')">Veja em português</a>
            } else {
                <a href="#" onclick="setLanguage('EN')">See in english</a>
            }

        </footer>
        <script style="font-size: 14" language="JavaScript">
                if(@usuario.getSolicitationsForCarona().size == 1){
                    window.alert("Você tem " + @usuario.getSolicitationsForCarona().size + " solicitação de carona")
                }else if (@usuario.getSolicitationsForCarona().size != 0){
                    window.alert("Você tem " + @usuario.getSolicitationsForCarona().size + " solicitações de carona")
                }
                $(function() {
                    $(".accept-solicitation").click(function() {
                        var id = $(this).data("solicitation-id");
                        var self = $(this);
                        $.ajax({
                            url: "/solicitations/accept/" + id,
                            type: "POST"
                        }).done(function(result) {
                            self.parent().parent().parent().addClass("alert alert-success");
                            self.parent().parent().parent().css("background-color", "#dff0d8");
                            self.parent().parent().find(".telephone").fadeIn();
                            self.parent().remove();
                        });
                    });
                    $(".reject-solicitation").click(function() {
                        var id = $(this).data("solicitation-id");
                        var self = $(this);
                        $.ajax({
                            url: "/solicitations/reject/" + id,
                            type: "DELETE"
                        }).done(function(result) {
                            self.parent().parent().parent().addClass("alert alert-danger");
                            self.parent().parent().parent().css("background-color", "#dca7a7");
                            self.parent().remove();
                        });
                    });
                })

                function setLanguage(language) {
                    $.ajax({
                        type: 'POST',
                        url: '/setLanguage/' + language,
                        success: function(response) {
                            window.location.href = '/perfilDriver';
                        },
                        error: function(response) {
                            alert("ERRO")
                        }
                    });
                }

        </script>
    </body>
</html>
}
